+++
title = "Virtualization"
author = ["Hrishikesh Barman"]
draft = false
+++

tags
: [Operating Systems]({{< relref "20221101172456-operating_systems.md" >}})


## Intro {#intro}

-   Virtualization: creating and running virtual machines
-   It is handled by something called a hypervisor
-   Hypervisor can either be:
    -   software
    -   firmware
    -   hardware


## Types {#types}


### Type 1 {#type-1}

> AKA True virtualization

-   Run on bare metal and typically leverage features of the CPU specifically built for virtualization. Eg. AMD-V and Intel VT-x.
-   Can only emulate the same architecture as of the host CPU
-   Examples
    -   KVM/Proxmox (Not exactly)
    -   VMWare ESXi.
    -   Microsoft Hyper-V


### Type 2 {#type-2}

> AKA Emulation

-   Run on top of a host OS, and thus it translates system calls made by the guest OS to system calls made to the host OS.
-   Can emulate any and all architectures regardless of the host CPU, at least in theory.
-   Examples
    -   QEMU. (Not exactly)
    -   VMWare Workstation.
    -   VirtualBox.


### Case about QEMU+KVM {#case-about-qemu-plus-kvm}

-   QEMU uses KVM
-   QEMU and KVM are neither type 1 nor type 2; somewhere in between.
-   If KVM Module
    -   Present: QEMU will leverage KVM and act halfway between type1&amp;2.
    -   Absent: QEMU will provide emulation rather than virtualisation.
-   About KVM itself, it's not strictly a type-1 hypervisor, as it still is part of an OS,


## Ecosystem {#ecosystem}


### Libvirt {#libvirt}

Libvirt is an open-source set of api, daemon, cli and libraries which provide a single way to manage multiple different hypervisors It can handle QEMU, KVM, Xen, LXC, OpenVZ, VMWare ESXi, etc.


### Some Notes {#some-notes}

-   VMWare offers graphics acceleration for Windows guests that seems to be unmatched in KVM (without using PCIe passthrough).
-   VirtualBox has a basic 3D acceleration support for Windows guests that KVM/QEMU still doesn't have without GPU passthrough.


## Others {#others}


### CPU Pinning {#cpu-pinning}

It moves processes from the host away from certain CPU cores, while devoting the guest entirely to these cores. This way, the 'pinned' CPU cores are dedicated to the VM,


## Resource {#resource}

-   [Virtualization and Hypervisors](https://sumit-ghosh.com/articles/virtualization-hypervisors-explaining-qemu-kvm-libvirt/)
