+++
title = "Observability"
author = ["Hrishikesh Barman"]
draft = false
+++

tags
: [Kubernetes]({{< relref "20221102125748-kubernetes.md" >}}), [PromQL]({{< relref "20221102122633-promql.md" >}})


## What's up w the ecosystem? {#what-s-up-w-the-ecosystem}

-   [Getting started with OpenTelemetry on Kubernetes | SigNoz](https://signoz.io/blog/opentelemetry-kubernetes/)


## FAQ {#faq}


### What about Performance? {#what-about-performance}

-   I'll have another page when I have it, but for now, this be it.
-   Outside scope of [Observability]({{< relref "20221102123214-observability.md" >}}) but consider things like
    -   Universal Scalability Law
    -   Amdahl's law (system limited by the seq processes)
    -   Little's law
    -   Kernel/Compiler level optimizations
-   See [Perf Little Book]({{< relref "20221101135342-perf_little_book.md" >}})


## What? {#what}

-   It's about bring better visibility into the system
-   It's a property of a system. Degree of system's observability is the degree to which it can be debugged.
-   Failure needs to be embraced
-   Once we have the info, we also need to know how to examine the info


### Checklist {#checklist}

-   [ ] Observability is not purely an operational concern.
    -   [ ] Allows test in prod.
    -   [ ] Reproducible failures
    -   [ ] Rollback/Forward flexibility
    -   [ ] Allows us to understand it when it runs
-   [ ] Let's us dig deeper v/s just let us know about the issue
-   [ ] Let's us debug better w evidence v/s conjecture/hypothesis


### The levels {#the-levels}


#### Primary {#primary}

-   Logs, Metrics, Traces
-   These need to be used in the right way to attain needed observability

<!--list-separator-->

-  Logs

    -   See [Logging]({{< relref "20221101183142-logging.md" >}})
    -   We don't tolerate loss here. Because we need this shit so we can query a needle in the haysack

<!--list-separator-->

-  Metrics

    -   System centric

<!--list-separator-->

-  Traces

    -   Request centric


#### Secondary {#secondary}

-   Exceptions (Thread local storage ([Threads]({{< relref "20221101173032-threads.md" >}})), stack trace)
-   Profiles (Mem, CPU, Mutex etc). Things that work here usually don't directly work with [Distributed Systems]({{< relref "20221102130004-distributed_systems.md" >}})


### Observability in dev/testing time {#observability-in-dev-testing-time}

-   Strive to write debuggable code (being able to ask questions in the future, via metrics, logs, traces, exceptions, combination etc)
-   We should be testing for failure aswell
    -   Best effort failure mode simulation, we can't catch all failure modes.
    -   We can be aware of the presence of failures
    -   We can't be aware of absence of failures ever
-   Assume the system will fail
-   Dev should be aware of things like
    -   How deployed? envars?. How it gets loaded/unloaded
    -   How it interacts w network? how it disconnects, exposed?
    -   How it handles IPC, configs
    -   How it discovers other stuff etc etc
-   Understand leaky abstractions of dependencies
    -   Default configs of dependencies
    -   Caching guarantees of dependencies
    -   Threading model of dependencies


### Testing in prod {#testing-in-prod}

-   Essentially means we can check something on a live system and the system allows us to see what's happening to the system when we want to check it.

{{< figure src="/ox-hugo/20221102123214-observability-1618516162.png" >}}


## Monitoring {#monitoring}


### Boxes {#boxes}

-   Blackbox: Symptom based(effect), less trigger(cause) based
-   Whiebox: We get data from inside of the system. (Detailed stuff)


### What it need to give {#what-it-need-to-give}

-   Show the failure
-   Impact of the failure
-   Ways to dig deeper
-   Effect of fix deployed


### What metrics to use? {#what-metrics-to-use}


#### USE (System Performance) {#use--system-performance}

-   U: Utilization
-   S: Saturation
-   E: Error


#### RED (Request Driven Applications) {#red--request-driven-applications}

-   R: Req. Rate
-   E: Error Rate
-   D: Duration of req (Histogram)


#### LETS (For Alerting) {#lets--for-alerting}

-   L: Latency
-   E: Error
-   T: Traffic
-   S: Saturation
