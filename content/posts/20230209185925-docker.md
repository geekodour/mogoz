+++
title = "Docker"
author = ["Hrishikesh Barman"]
draft = false
+++

tags
: [Containers]({{< relref "20230218104617-containers.md" >}})

Ya allah.


## Random notes {#random-notes}


### About layers and bloat {#about-layers-and-bloat}

-   Layers can add bloat to a docker file. This depends very much on the specifics of what the `RUN` steps are doing and the order of them.
-   Eg. Just changing files will often create a layer with another copy of those files with the different attributes (e.g. chmod). That means you have very similar content in two separate layers which creates bloat.
-   Eg. Issue with the design of layers is that you data never gets deleted. i.e Doing something like `RUN apt-get install foo` `RUN foo generate-things` `RUN apt-get uninstall foo` will effectively still have `foo` in the image.
-   This can be contained however (pun intended)
    -   When developing scripts for running inside Docker, to copying of the script as late as possible in the Dockerfile so that the preceding layers can be reused
    -   It is possible with `build stages/multi staged builds` and `copy from`, but not super trivial.


### Docker and firewalls {#docker-and-firewalls}

Hmm See [Firewalls]({{< relref "20230306125249-firewalls.md" >}})


## History {#history}

-   Started out being built on top of `LXC`
-   Later moved beyond `LXC` containers to its own execution environment called `libcontainer`.


## Things I keep hearing about {#things-i-keep-hearing-about}

-   run mounts
-   containerd ecosystem
-   overly filesystems like AUFS and overlayfs
-   Linux bridge infrastructure and how Linux routing works.


## Things to read {#things-to-read}

-   [The differences between Docker, containerd, CRI-O and runc - Tutorial Works](https://www.tutorialworks.com/difference-docker-containerd-runc-crio-oci/?_hsmi=213803458)
