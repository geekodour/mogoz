+++
title = "Linux"
author = ["Hrishikesh Barman"]
draft = false
+++

## Important links {#important-links}

-   [The Linux Kernel documentation â€” The Linux Kernel documentation](https://www.kernel.org/doc/html/latest/index.html)
-   [Linux source code (v6.2.9) - Bootlin](https://elixir.bootlin.com/linux/latest/source)
-   [Human Redable Summary of Each Kernel Release ðŸ˜¸](https://kernelnewbies.org/LinuxVersions)
-   [Linux Versions](https://en.wikipedia.org/wiki/Linux_kernel_version_history)


## Nvidia and Linux {#nvidia-and-linux}


### MXM {#mxm}

-   MXM support shows as VGA Controller in lspci (dedicated graphics)
    -   This easy, we can run standalone
-   MXM non-support shows as 3D Controller in lspci (laptops)
    -   We need to use [Nvidia Optimus - Wikipedia](https://en.wikipedia.org/wiki/Nvidia_Optimus)
    -   Current solution: Nvidia PRIME
    -   Previous solution: Bumblebee (now deprecated)


### Drivers {#drivers}

-   opensource &amp; prop.


## Nix {#nix}


### NixOS {#nixos}

-   NixOS does away with FHS with nix-store
    -   nix-store output = hash of recipie + package name + package version
    -   This allows nix-store
        -   to have different versions of the same software package
        -   to have same version but compiled with different flags aswell!
-   Has some FHS stuff to keep things posix compliant, eg `/bin/sh`, `/usr/bin/env`, all other stuff goes into `/nix/store` and everything else gets symlinked from `/run/current-system`


#### Module system {#module-system}

{{< figure src="/ox-hugo/20221101150211-linux-1906375794.png" >}}


#### Tools {#tools}

-   `nixos-option services.interception-tools.plugins` to dig down on options available
-   home manager options: <https://mipmip.github.io/home-manager-option-search/?query=keychain>
-   <https://lazamar.co.uk/nix-versions/>


### Package manager usage {#package-manager-usage}

{{< figure src="/ox-hugo/20221101150211-linux-1876836128.png" >}}


#### nix-env {#nix-env}

-   `nix-env` tool manages environments, profiles and their generations.
-   `nix-env -i` installs stuff
-   Using this is an **anti-pattern**, we go back to what we had before in non nixos. One global package for everything.


#### nix-shell {#nix-shell}

-   It only provides a bash shell, but that's mostly all you need.
-   Ephemeral
    -   This allows us to do shit like `nix-shell -p go1.16 -p nodejs23` and then `nix-shell -p go1.20 -p ruby3` and it'll just spin up those environments for us without polluting them in the global namespace.
-   Reusable environments
    -   This is nice, picks shell.nix / default.nix from current directory
    -   Same idea of ephemeral but now into a file and now can be re-produced anywhere


### Pain points {#pain-points}

-   [Installing ruff via pip on NixOs does not work Â· Issue #1699 Â· astral-sh/ruff Â· GitHub](https://github.com/astral-sh/ruff/issues/1699)


### Ref links {#ref-links}

-   [Nix revisited - Charlotte's notes](https://lottia.net/notes/0003-nix-revisited.html)
-   [Packaging/Quirks and Caveats - NixOS Wiki](https://nixos.wiki/wiki/Packaging/Quirks_and_Caveats#ImportError:_libstdc.2B.2B.so.6:_cannot_open_shared_object_file:_No_such_file)
-   [Nix By Example | &lt;fun&gt;](https://mimoo.github.io/nixbyexample/basics-setup.html)
-   [Nix shell template | Lobsters](https://lobste.rs/s/xc37sv/nix_shell_template)
-   [Packaging/Binaries - NixOS Wiki](https://nixos.wiki/wiki/Packaging/Binaries)
-   [Understanding Nix Inputs #nix Â· GitHub](https://gist.github.com/CMCDragonkai/45359ee894bc0c7f90d562c4841117b5)
-   <https://github.com/nix-community/disko>
-   [Nix Flakes is an experiment that did too much at onceâ€¦ | Lobsters](https://lobste.rs/s/wamkim/nix_flakes_is_experiment_did_too_much_at)
-   <https://galowicz.de/2023/04/05/single-command-server-bootstrap/>
-   Devops
    -   <https://github.com/pdtpartners/nix-snapshotter>
    -   <https://nixery.dev/>
    -   [Making NixOS modules for fun and (hopefully) profit - Xe Iaso](https://xeiaso.net/talks/asg-2023-nixos)
